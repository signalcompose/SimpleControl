# SimpleControl
SimpleControl provides rough and high definition communication protocol between anyware

## 背景

* MIDI
  * 解像度が足りない、速度が遅い、古すぎる
  * 命令と機能が厳密に決められすぎていて足かせになることがある
* CVによる操作はモジュラーシンセ周りだけでしか扱われていない
* 照明関係もDMXで閉じてしまっている
* OSCではEthernet, IPv4/v6, TCP/UDP という部分の実装コストが高い、送信先を指定するアドレスが文字列で扱いにくい

異なる領域同士の連携を行う時のコストが高い。規格が古くて現在求められている情報量を扱いきれていない。
高機能過ぎて実装や設定が煩雑になる。

## SimpleControlの仕様

```

+----+----+----+----+----+----+----+----++----+----+----+----+----+----+----+----+
|    |    |    |    |    |    |    |    ||    |    |    |    |    |    |    |    |
+----+----+----+----+----+----+----+----++----+----+----+----+----+----+----+----+

|--------address(32bit int)-------------||--------data(32bit float)--------------|

```

### 必須項目

* 4byte の整数型アドレス
* 4byte のfloat型データ

### 通信規格について(推奨設定)

* 規定しない
  * TCP/UDP、USBシリアル、Blutooth、HTTP(S)、I2C、どれであろうとこの形式で送受信できれば利用できる
  * 既存の規格に送受信できそうな余白があれば積極的に利用する

* パラレルで送る場合に1メッセージの形式は崩さない
  * 4回線の場合の例
    ```
    --------------------| address | data   |-------------->
    -------------| address | data   |--------------------->
    -------------------------| address | data   |--------->
    ---------------------| address | data   |------------->
    ```

* エンディアン
  * メッセージを乗せる規格に従う

* 通信速度について
  * メッセージを乗せる規格に従う

* エラー処理について
  * メッセージを乗せる規格に従う
  * 規格にエラー検出が存在しない場合、エラー検出用CRCを追加したものも検討中

* メッセージ以外の送受信
  * メッセージを乗せる規格に従う
  * Ethernetを利用するのであればPoEで電源供給なども考えられる

### アドレス割当について(推奨設定)

* IPv4のようなサブネットマスクの方式を利用して、各種パラメータへのアサインを振り分ける使い方が想定できる
  * ホスト最大値はブロードキャストになる

### データ形式について(推奨設定)

* 基本は -1.0 - 1.0 の間でデータ送信を行う

### 利用規約について

* 商用、非商用問わずこの規格を利用、改変することができる
* この規格そのものによって利益を得ることはできない
  * この規格に何らかの拡張をしたものに関してはその限りではない
* 自由にこの規格を別の規格でラップすることができる
  * 例
    ```
    +----------------------------------------------------------------+
    | +--------------------------------------+                       |
    | |  Simple Control                      |   other protocol      |
    | +--------------------------------------+                       |
    +----------------------------------------------------------------+
    ```
  * ラップする規格の利用規約に注意すること
* この規格の内部に別の規格を含ませてはならない
  * 例
    ```
    SimpleControl
    +-----------address--------------+---------------data------------------+
    | +------------------------+     | +--------------------------------+  |
    | |  other protocol A      |     | | other protocol B               |  |
    | +------------------------+     | +--------------------------------+  |
    +--------------------------------+-------------------------------------+
    ```

### MIDIとの互換性

#### ベロシティ問題

##### 問題点

* https://www.g200kg.com/jp/docs/dic/noteon.html
* ノート番号とベロシティという2つが一緒に送られてくる

##### 実装の解決策

* 先にベロシティを送り、次にノート番号を送ることで、ベロシティ値をノート番号に割り当てる
* 別途複数のデータを渡すプロトコルを作成する
